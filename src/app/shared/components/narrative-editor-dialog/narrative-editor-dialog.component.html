@if (show()) {
  <!-- Modal backdrop -->
  <div class="modal-backdrop d-block" style="background: rgba(0,0,0,0.5); z-index: 1060"></div>

  <!-- Modal -->
  <div class="modal d-block" style="z-index: 1061" tabindex="-1">
    <div class="modal-dialog modal-xl modal-dialog-centered">
      <div class="modal-content">
        <!-- Header -->
        <div class="modal-header p-2 pe-3">
          <h5 class="modal-title">
            <i class="fas fa-edit me-2"></i>
            Edit Narrative Template
          </h5>
          <button type="button" class="btn-close" (click)="closeDialog()"></button>
        </div>

        <!-- Body -->
        <div class="modal-body p-0" style="height: 60vh">
          <app-monaco-editor #monacoEditor
            [value]="narrativeContent()"
            (valueChange)="narrativeContent.set($event)"
            [readOnly]="false"
            language="handlebars">
          </app-monaco-editor>
        </div>

        <!-- Footer -->
        <div class="modal-footer p-1">
          <button type="button" class="btn btn-sm btn-danger" (click)="closeDialog()">
            <i class="fas fa-times me-2"></i>
            Cancel
          </button>
          <button type="button" class="btn btn-sm btn-success" (click)="saveNarrative()" [disabled]="loading()">
            @if (loading()) {
              <span class="spinner-border spinner-border-sm me-2"></span>
              Saving...
            } @else {
              <i class="fas fa-save me-2"></i>
              Save
            }
          </button>
        </div>
      </div>
    </div>
  </div>
}
